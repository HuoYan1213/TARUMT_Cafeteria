<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../../js/public.js"></script>
    <style>
        /* --- 佈局 --- */
body {
    background-color: #F9F7F2; /* 稍微亮一點的米色，讓白色卡片更明顯 */
}



/* --- 右側：訂單摘要 --- */
.checkout-summary-section {
    flex: 1; /* 比較窄 */
    position: sticky;
    top: 30px; /* 滾動時固定 */
}

.summary-card {
    background: white;
    border-radius: 16px;
    padding: 30px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.05); /* 現代感的柔和陰影 */
}

.summary-card h3 {
    font-family: 'Playfair Display', serif;
    color: #4B3621;
    margin-top: 0;
    margin-bottom: 20px;
}

.summary-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    font-size: 14px;
    color: #555;
}

.item-qty {
    font-weight: bold;
    color: #A64B2A;
    margin-right: 5px;
}

.divider {
    height: 1px;
    background: #EEE;
    margin: 20px 0;
}

.price-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    color: #666;
    font-size: 14px;
}

.price-row.total {
    color: #4B3621;
    font-weight: 800;
    font-size: 20px;
    margin-top: 15px;
}

.pay-btn {
    width: 100%;
    background-color: #4B3621;
    color: #F5F1E6;
    border: none;
    border-radius: 10px;
    padding: 16px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    margin-top: 25px;
    transition: background 0.3s;
}

.pay-btn:hover {
    background-color: #A64B2A;
}


        </style>
</head>
<body>

<div class="checkout-wrapper">
    
    <div class="checkout-form-section">
        <div class="section-header">
            <a href="cart.html" class="back-btn"><i class="fa-solid fa-chevron-left"></i> Back</a>
            <h1>Checkout</h1>
        </div>

<div class="form-group">

</div>

    <div class="checkout-summary-section">
        <div class="summary-card">
            <h3>Order Summary</h3>
            
            <div class="order-items-scroll" id="order-items-container">
                <div class="summary-item-loader">Loading cart...</div>
            </div>

            <div class="divider"></div>

            <div class="price-row">
                <span>Subtotal</span>
                <span id="subtotal">RM 0.00</span>
            </div>
            <div class="price-row">
                <span>SST (6%)</span>
                <span id="tax">RM 0.00</span>
            </div>
            
            <div class="divider"></div>

            <div class="price-row total">
                <span>Total</span>
                <span id="total">RM 0.00</span>
            </div>

            <button id="pay-now-btn" class="pay-btn">
                Place Order
            </button>
        </div>
    </div>

</div>

<script>
$(document).ready(function() {
    
    // 1. 模擬數據 (你需要換成 AJAX 請求)
    let cartItems = [
        { name: "Vintage Latte", price: 12.00, qty: 1, img: "latte.jpg" },
        { name: "Nasi Lemak Special", price: 15.90, qty: 2, img: "nasi.jpg" }
    ];

    renderSummary(cartItems);

    function renderSummary(items) {
        let html = '';
        let subtotal = 0;

        items.forEach(item => {
            let total = item.price * item.qty;
            subtotal += total;
            html += `
                <div class="summary-item">
                    <div class="item-text">
                        <span class="item-qty">${item.qty}x</span>
                        <span class="item-name">${item.name}</span>
                    </div>
                    <span class="item-price">RM ${total.toFixed(2)}</span>
                </div>
            `;
        });

        $('#order-items-container').html(html);
        
        let tax = subtotal * 0.06;
        let finalTotal = subtotal + tax;

        $('#subtotal').text('RM ' + subtotal.toFixed(2));
        $('#tax').text('RM ' + tax.toFixed(2));
        $('#total').text('RM ' + finalTotal.toFixed(2));
    }

    // 2. 處理卡片點擊效果 (讓 Radio 更好看)
    // 針對 Dining Option
    $('.option-card input').change(function() {
        $('.option-card').removeClass('active');
        $(this).closest('.option-card').addClass('active');
    });

    // 針對 Payment Method
    $('.payment-card input').change(function() {
        $('.payment-card').removeClass('active');
        $(this).closest('.payment-card').addClass('active');
    });

    // 3. 付款按鈕
    $('#pay-now-btn').click(function() {
        let dining = $('input[name="dining_type"]:checked').val();
        let payment = $('input[name="payment_method"]:checked').val();
        
        if(!payment) {
            showToast("Please select a payment method!", "error");
            return;
        }

        // 模擬付款
        $(this).prop('disabled', true).text('Processing...');
        setTimeout(() => {
            showToast("Order Placed! ID: 25OR0088", "success");
            $(this).prop('disabled', false).text('Place Order');
        }, 1500);
    });
});
</script>

</body>
</html>